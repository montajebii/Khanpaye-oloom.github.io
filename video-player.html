<!doctype html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>پخش ویدیو | خان‌پایه</title>
  <meta name="description" content="پخش ویدیوی آموزشی علوم با کیفیت بالا، همراه با جزوه و نکات کلیدی." />
  <meta name="keywords" content="پخش ویدیو علوم, آموزش علوم, ویدیو آموزشی" />
  <meta name="author" content="خان‌پایه" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#0f6a5f" />
  <link rel="canonical" href="https://khanpaye-oloom.github.io/video-player.html" />
  <link rel="icon" href="favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="assets/CSS/style.css" />
  <meta property="og:title" content="پخش ویدیو | خان‌پایه" />
  <meta property="og:description" content="پخش ویدیوی آموزشی علوم با کیفیت بالا." />
  <meta property="og:type" content="video.other" />
  <meta property="og:url" content="https://khanpaye-oloom.github.io/video-player.html" />
  <meta property="og:image" content="https://khanpaye-oloom.github.io/assets/images/hero.jpg" />
  <meta property="og:site_name" content="خان‌پایه" />
  <meta property="og:locale" content="fa_IR" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="پخش ویدیو | خان‌پایه" />
  <meta name="twitter:description" content="پخش ویدیوی آموزشی علوم با کیفیت بالا." />
  <meta name="twitter:image" content="https://khanpaye-oloom.github.io/assets/images/hero.jpg" />
  <script defer data-domain="khanpaye-oloom.github.io" src="https://plausible.io/js/script.js"></script>
</head>

<body>
  <a class="skip-link" href="#content">رفتن به محتوا</a>
  <header class="site-header">
    <div class="wrap header-inner">
      <div class="brand">
        <div class="brand-mark">خ</div>
        <div class="brand-title">
          خان‌پایه
          <span>علوم 0 تا 100</span>
        </div>
      </div>
      <nav class="main-nav" aria-label="منوی اصلی">
        <a href="index.html">خانه</a>
        <a href="library.html">کتابخانه</a>
        <a href="about.html">درباره دبیر</a>
        <a href="contact.html">ارتباط</a>
      </nav>
      <div class="header-actions">
        <a class="btn btn-ghost" href="library.html">بازگشت به کتابخانه</a>
        <a class="btn btn-primary" href="contact.html">درخواست مشاوره</a>
      </div>
      <button class="mobile-toggle" type="button" data-mobile-toggle aria-label="باز کردن منو">☰</button>
    </div>
  </header>

  <div class="mobile-panel" data-mobile-panel>
    <nav aria-label="منوی موبایل">
      <a href="index.html">خانه</a>
      <a href="library.html">کتابخانه</a>
      <a href="about.html">درباره دبیر</a>
      <a href="contact.html">ارتباط</a>
      <a class="btn btn-primary" href="contact.html">درخواست مشاوره</a>
    </nav>
  </div>

  <main id="content" class="section">
    <div class="wrap video-player">
      <div class="video-meta">
        <span class="tag" data-video-tag>ویدیو آموزشی</span>
        <h1 data-video-title>پخش ویدیوی آموزشی</h1>
        <p data-video-description>ویدیو را تماشا کنید و سپس جزوه‌های مرتبط را برای مرور سریع دانلود کنید.</p>
        <div class="actions">
          <a class="btn btn-ghost" href="library.html">بازگشت به کتابخانه</a>
          <a class="btn btn-primary" href="contact.html">پرسش از دبیر</a>
        </div>
      </div>
      <div class="video-frame" data-video-frame></div>

      <section class="section" style="padding: 0;">
        <div class="grid-3" data-video-actions></div>
      </section>

      <section class="section" style="padding: 0;">
        <div>
          <h2 class="section-title">درس‌های مرتبط</h2>
          <p class="section-subtitle">محتواهای پیشنهادی بر اساس همین مبحث.</p>
          <div class="library-grid" data-related-lessons></div>
        </div>
      </section>
    </div>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <div class="footer-grid">
        <div>
          <h4>خان‌پایه</h4>
          <p>پلتفرم آموزش علوم برای پایه‌های هفتم تا نهم.</p>
        </div>
        <div>
          <h4>دسترسی سریع</h4>
          <a href="library.html">کتابخانه</a>
          <a href="contact.html">ارتباط</a>
        </div>
        <div>
          <h4>راه‌های ارتباطی</h4>
          <a href="mailto:info@khanpaye.ir">info@khanpaye.ir</a>
          <a href="tel:+989000000000">+98 900 000 0000</a>
        </div>
      </div>
      <div class="footer-bottom">
        <span>© <span data-year></span> خان‌پایه. همه حقوق محفوظ است.</span>
        <span>ویدیو + تمرین + جزوه</span>
      </div>
    </div>
  </footer>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const videoId = params.get('id');
      const frame = document.querySelector('[data-video-frame]');
      const titleEl = document.querySelector('[data-video-title]');
      const descEl = document.querySelector('[data-video-description]');
      const tagEl = document.querySelector('[data-video-tag]');
      const actionsEl = document.querySelector('[data-video-actions]');
      const relatedEl = document.querySelector('[data-related-lessons]');

      const createActionCard = (icon, title, desc, link, label) => `
        <article class="feature-card">
          <div class="feature-icon">${icon}</div>
          <h3>${title}</h3>
          <p>${desc}</p>
          <a class="btn btn-ghost" href="${link}">${label}</a>
        </article>
      `;

      const createRelatedCard = (item) => `
        <article class="library-card">
          <span class="tag">${item.typeLabel}</span>
          <h3>${item.title}</h3>
          <p>${item.summary}</p>
          <div class="library-meta">
            <span>پایه ${item.grade}</span>
            <span>${item.duration}</span>
            <span>${item.level}</span>
          </div>
          <div class="actions">
            <a class="btn btn-primary" href="${item.link}">${item.action}</a>
            <a class="btn btn-ghost" href="${item.secondaryLink}">${item.secondaryAction}</a>
          </div>
        </article>
      `;

      const renderAparatEmbed = (aparatId) => {
        if (!frame) return;
        const rnd = String(Date.now());
        frame.innerHTML = `
          <div id="${rnd}">
            <script type="text/JavaScript"
              src="https://www.aparat.com/embed/${aparatId}?data[rnddiv]=${rnd}&data[responsive]=yes&titleShow=true&recom=self"></script>
  </div>
  `;
  };

  fetch('assets/content/library.json')
  .then((response) => response.json())
  .then((data) => {
  const videos = data.videos || [];
  const notes = data.notes || [];
  const selectedVideo = videos.find((video) => video.id === videoId) || videos[0];

  if (!selectedVideo) {
  return;
  }

  const videoTitle = selectedVideo.title;
  const videoSummary = selectedVideo.summary;
  const aparatId = selectedVideo.aparatId;
  const notesMap = Object.fromEntries(notes.map((note) => [note.id, note]));
  const relatedNotes = (selectedVideo.notes || [])
  .map((id) => notesMap[id])
  .filter(Boolean);

  if (aparatId) {
  renderAparatEmbed(aparatId);
  }

  if (titleEl) {
  titleEl.textContent = videoTitle;
  }

  if (descEl) {
  descEl.textContent = videoSummary;
  }

  if (tagEl) {
  tagEl.textContent = `پایه ${selectedVideo.grade} · ${selectedVideo.topic}`;
  }

  document.title = `${videoTitle} | پخش ویدیو - خان‌پایه`;

  if (actionsEl) {
  const noteLink = relatedNotes[0]
  ?
  `note-viewer.html?file=${encodeURIComponent(relatedNotes[0].file)}&title=${encodeURIComponent(relatedNotes[0].title)}`
  : 'library.html?type=notes';
  actionsEl.innerHTML =
  createActionCard('📝', 'جزوه مرتبط', 'جزوه را دانلود کن و نکات کلیدی را مرور کن.', noteLink, 'مشاهده جزوه') +
  createActionCard('✅', 'تمرین سریع', 'تمرین‌های کوتاه برای تثبیت مطالب همین بخش.', 'library.html?type=quiz', 'مشاهده
  تمرین‌ها') +
  createActionCard('💬', 'رفع اشکال', 'سوالاتت را ارسال کن تا در سریع‌ترین زمان پاسخ بگیری.', 'contact.html', 'ارسال
  سوال');
  }

  const relatedItems = videos
  .filter((video) => video.id !== selectedVideo.id)
  .filter((video) => video.grade === selectedVideo.grade || video.topic === selectedVideo.topic)
  .slice(0, 3)
  .map((video) => ({
  title: video.title,
  summary: video.summary,
  grade: video.grade,
  typeLabel: 'ویدیو',
  duration: video.duration,
  level: video.level,
  action: 'پخش ویدیو',
  secondaryAction: 'مشاهده جزوه',
  link: `video-player.html?id=${encodeURIComponent(video.id)}`,
  secondaryLink: 'library.html?type=notes&grade=' + encodeURIComponent(video.grade)
  }));

  if (relatedEl) {
  relatedEl.innerHTML = relatedItems.length
  ? relatedItems.map(createRelatedCard).join('')
  : '<p>درس مرتبط دیگری برای این ویدیو ثبت نشده است.</p>';
  }

  const videoSchema = {
  "@context": "https://schema.org",
  "@type": "VideoObject",
  "name": videoTitle,
  "description": videoSummary,
  "thumbnailUrl": aparatId ? `https://www.aparat.com/cover/${aparatId}/` : undefined,
  "uploadDate": "2026-02-04",
  "embedUrl": aparatId ? `https://www.aparat.com/embed/${aparatId}` : undefined
  };

  let schemaEl = document.querySelector('#video-schema');
  if (!schemaEl) {
  schemaEl = document.createElement('script');
  schemaEl.type = 'application/ld+json';
  schemaEl.id = 'video-schema';
  document.head.appendChild(schemaEl);
  }
  schemaEl.textContent = JSON.stringify(videoSchema);
  });
  })();
  </script>
  <script src="assets/JS/main.js"></script>
</body>

</html>